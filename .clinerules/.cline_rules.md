# Cline Workspace Rules for Wauw & Pittigman Spelling Bee

## Project Overview

This is a real-time Dutch spelling bee web application built with Next.js 15, TypeScript, Pusher Channels, and PostgreSQL with Prisma ORM. The application has two main interfaces: a judge interface for game control and a display interface for contestants.

## Tech Stack & Architecture

-   **Framework**: Next.js 15 with App Router
-   **Language**: TypeScript (strict mode)
-   **Database**: PostgreSQL with Prisma ORM
-   **Real-time**: Pusher Channels for WebSocket communication
-   **Styling**: Tailwind CSS v4
-   **UI Components**: Radix UI with shadcn/ui
-   **Package Manager**: Yarn (required)
-   **Deployment**: Vercel-optimized serverless

## File Structure & Conventions

### Directory Structure

```
src/
├── app/                    # Next.js App Router pages
│   ├── api/               # API routes
│   │   ├── pusher/        # Real-time event endpoints
│   │   └── words/         # Word management endpoints
│   ├── display/           # Display interface (contestant view)
│   ├── judge/             # Judge interface (control panel)
│   ├── words/             # Word management interface
│   └── page.tsx           # Home page (session creation)
├── components/ui/         # Reusable UI components (shadcn/ui)
└── lib/                   # Utility libraries and configurations
    ├── prisma.ts          # Database client
    ├── pusher.ts          # Pusher server configuration
    ├── realtime.ts        # Real-time communication wrapper
    ├── timer-config.ts    # Timer configuration
    ├── words.ts           # Word database operations
    └── difficulty-utils.ts # Difficulty level utilities

prisma/
├── schema.prisma          # Database schema
└── seed.ts               # Database seeding script
```

### Naming Conventions

-   **Files**: kebab-case for multi-word files (e.g., `timer-config.ts`)
-   **Components**: PascalCase (e.g., `DisplayPage`)
-   **Functions**: camelCase (e.g., `getRandomWord`)
-   **Constants**: SCREAMING_SNAKE_CASE (e.g., `DEFAULT_TIMER_CONFIG`)
-   **Database tables**: PascalCase (e.g., `Word`)
-   **API routes**: kebab-case directories (e.g., `/api/pusher/word-selected`)

## Development Patterns

### Database Operations

-   Always use Prisma Client for database operations
-   Use type-safe operations with generated Prisma types
-   Handle database connections properly (disconnect when needed)
-   Use transactions for complex operations
-   Follow the established Word model schema

### Real-time Communication

-   Use the `useSpellingBeeRealtime` hook for components
-   All real-time events use channel format: `spelling-bee-{roomCode}`
-   Event naming: kebab-case (e.g., `word-selected`, `timer-start`)
-   Always handle connection states and errors
-   Use proper event cleanup in useEffect

### API Route Structure

-   Use Next.js 15 App Router API format
-   Export named functions: `GET`, `POST`, etc.
-   Always handle errors with try-catch
-   Return proper HTTP status codes
-   Use TypeScript for request/response types

### Component Patterns

-   Use functional components with hooks
-   Use Suspense for loading states
-   Implement proper error boundaries
-   Use shadcn/ui components consistently
-   Follow responsive design patterns

### Styling Guidelines

-   Use Tailwind CSS v4 classes
-   Follow existing color scheme and spacing
-   Use CSS variables for theme colors
-   Implement dark mode support where applicable
-   Maintain responsive design (mobile-first)

## Environment & Configuration

### Required Environment Variables

```env
DATABASE_URL="postgresql://..."
PUSHER_APP_ID=your_app_id
PUSHER_KEY=your_key
PUSHER_SECRET=your_secret
PUSHER_CLUSTER=your_cluster
NEXT_PUBLIC_PUSHER_KEY=your_key
NEXT_PUBLIC_PUSHER_CLUSTER=your_cluster
```

### Development Commands

-   `yarn dev` - Start development server
-   `yarn build` - Build for production
-   `yarn db:seed` - Seed database with Dutch words
-   `npx prisma generate` - Generate Prisma client
-   `npx prisma db push` - Push schema changes

## Code Quality Standards

### TypeScript

-   Use strict TypeScript configuration
-   Prefer explicit typing over `any`
-   Use Prisma-generated types for database operations
-   Define interfaces for complex data structures
-   Use proper error handling with typed errors

### Error Handling

-   Always wrap database operations in try-catch
-   Provide meaningful error messages
-   Handle network failures gracefully
-   Log errors appropriately for debugging
-   Use proper HTTP status codes in API routes

### Performance Considerations

-   Use React.memo for expensive components
-   Implement proper loading states
-   Optimize database queries
-   Use efficient re-rendering patterns
-   Consider caching for static data

## Specific Implementation Guidelines

### Timer System

-   Use `DEFAULT_TIMER_CONFIG` from `lib/timer-config.ts`
-   Implement three phases: green (60s), yellow (30s), red (30s)
-   Use proper cleanup for timer intervals
-   Sync timer state between interfaces

### Word Management

-   Use difficulty enum: `VERY_EASY | EASY | MEDIUM | HARD | VERY_HARD`
-   Implement proper word filtering and selection
-   Maintain Dutch language content standards
-   Use database operations for all word CRUD

### Real-time Events

-   Follow established event patterns
-   Use proper room isolation with room codes
-   Handle connection states gracefully
-   Implement proper event cleanup

### UI/UX Standards

-   Maintain Dutch language interface
-   Use consistent branding ("Wauw & Pittigman Spelling Bee")
-   Implement proper loading and error states
-   Follow accessibility best practices
-   Ensure mobile responsiveness

## Testing & Deployment

### Before Deployment

-   Run `yarn build` to check for build errors
-   Test real-time functionality across interfaces
-   Verify database operations work correctly
-   Check environment variables are set
-   Test responsive design on different screen sizes

### Production Considerations

-   Application is optimized for Vercel deployment
-   Database should be production PostgreSQL
-   Pusher should be configured for production usage
-   Environment variables must be set in deployment platform
-   Monitor real-time connection stability

## Common Pitfalls to Avoid

1. **Database**: Don't forget to disconnect Prisma client in server-side operations
2. **Real-time**: Always clean up event listeners in useEffect cleanup
3. **Timer**: Avoid memory leaks with proper interval cleanup
4. **State**: Don't mutate state directly, use proper state setters
5. **Environment**: Never commit `.env.local` or expose secrets
6. **Build**: Check TypeScript errors before deployment
7. **Routes**: Use proper HTTP methods and status codes in API routes

## When Making Changes

1. **Database Changes**: Update Prisma schema first, then run `npx prisma db push`
2. **New Components**: Follow shadcn/ui patterns and Tailwind classes
3. **API Changes**: Update both client and server code consistently
4. **Real-time Events**: Update both sender and receiver interfaces
5. **Documentation**: Update README.md if functionality changes significantly

This project follows established patterns - study existing code before implementing new features to maintain consistency.
